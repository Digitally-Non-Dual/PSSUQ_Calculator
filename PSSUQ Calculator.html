<div class="sqs-block-content"><!-- HTML, CSS, and JavaScript code for the Updated PSSUQ Calculator with Text Color Adjustments -->
<!-- Begin HTML Structure -->
<div class="pssuq-calculator">
  <h2>PSSUQ Calculator</h2>
  <p><b>Welcome! ðŸ™‚<br> Simply copy and paste your data from Excel or Google Sheets.</b></p>

  <!-- Results Display -->
  <div class="results">
    <h3>Results</h3>
    <p>System Usefulness Average: <span id="sysuse-result">-</span></p>
    <p>Information Quality Average: <span id="infoqual-result">-</span></p>
    <p>Interface Quality Average: <span id="interqual-result">-</span></p>
    <p><strong>Overall PSSUQ Score: <span id="overall-result">-</span></strong></p>
  </div>

  <!-- Controls -->
  <div class="controls">
    <div class="control-group">
      <label>Add participants:</label>
      <input type="text" id="add-participants-number" value="1">
      <button id="add-participants-button">Add</button>
    </div>
    <div class="control-group">
      <label>Remove participant rows:</label>
      <input type="text" id="remove-start-number">
      <input type="text" id="remove-end-number">
      <button id="remove-participants-button">Remove</button>
    </div>
    <div class="control-group">
      <button id="clear-data-button">Clear Data</button>
      <button id="undo-clear-button" disabled="">Undo</button>
    </div>
  </div>

  <!-- Table for Participant Data -->
  <div class="table-container">
    <div class="question_numbers">
            </div><table id="pssuq-table" class="input-table">
      <thead>
        <tr>
          <th rowspan="2">Participant<br>Number</th>
          <!-- Subscale Headers -->
          <th colspan="6">System Usefulness (SYSUSE)</th>
          <th colspan="6">Information Quality (INFOQUAL)</th>
          <th colspan="4">Interface Quality (INTERQUAL)</th>
        </tr>
        <tr>
          <!-- Question Numbers 1-16 -->
          <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th>
            <th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th>
            <th>13</th><th>14</th><th>15</th><th>16</th>
          
        </tr>
      </thead>
      <tbody>
        <!-- Initially 10 participant rows -->
        <!-- Rows will be generated by JavaScript -->
      <tr><td style="color: rgb(0, 0, 0);">1</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">2</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">3</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">4</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">5</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">6</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">7</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">8</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">9</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr><tr><td style="color: rgb(0, 0, 0);">10</td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td><td contenteditable="true" style="user-select: text; color: rgb(0, 0, 0);"></td></tr></tbody>
    </table>
  </div>

  <!-- Calculate Button -->
  <div class="button-container">
    <button id="calculate-button">Calculate</button>
  </div>
  <div class="footer" style="background-color: white; color: black; text-align: center; padding: 35px; margin-top: 20px;">
    <p>Thank you for using the PSSUQ Calculator!</p>
  </div>
</div>
<!-- End HTML Structure -->

<!-- Begin CSS Styling -->
<style>
  .pssuq-calculator {
    max-width: 100%;
    margin: auto;
    font-family: 'Lato', sans-serif;
    font-size: 1.4rem;
    background-color: #ffffff; /* Set background to white */
    color: #000; /* Set text color to black */
  }
  .pssuq-calculator h2 {
    padding-top: 40px; /* Adjust the value if needed */
  }  
  
  .pssuq-calculator .results h3 {
    margin: 1.0rem 0 !important; /* Adjust '0.5rem' to whatever spacing you want */
  }
  
  .pssuq-calculator h2, .pssuq-calculator h3 {
    font-family: 'Lato', sans-serif;
    text-align: center;
    color: #000; /* Ensure heading text is black */
  }
  .pssuq-calculator p {
    text-align: center;
    color: #000; /* Ensure paragraph text is black */
  }
  .question_numbers {
    max-width: 100%;
    margin: auto;
    font-family: 'Lato', sans-serif;
    font-size: 0.9rem;
    color: #000; /* Set text color to black */
  }
  .controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-bottom: 20px;
  }
  .control-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .control-group label {
    font-weight: bold;
    color: #000; /* Ensure label text is black */
  }
  .control-group input[type="text"] {
    width: 60px;
    padding: 5px;
    font-size: 16px;
    color: #000; /* Ensure input text is black */
    border: 1px solid #ccc;
  }
  .control-group button {
    padding: 10px 15px;
    background-color: #000; /* Black background */
    color: #fff; /* White text */
    border: none;
    font-size: 16px;
    cursor: pointer;
  }
  .control-group button:hover {
    background-color: #333;
  }
  .table-container {
    width: 100%;
    overflow-x: auto;
    margin-bottom: 20px;
  }
  .pssuq-calculator .input-table {
    width: 100%;
    border-collapse: collapse;
  }
  .pssuq-calculator .input-table th, .pssuq-calculator .input-table td {
    border: 1px solid #ccc;
    padding: 8px;
    min-width: 80px;
    text-align: center;
    user-select: text; /* Allows multi-cell selection */
    color: #000; /* Ensure table text is black */
  }
  .pssuq-calculator .input-table th {
    background-color: #f2f2f2;
    color: #000; /* Ensure header text is black */
  }
  /* Participant Number Cells */
  .pssuq-calculator .input-table tbody td:first-child {
    background-color: #f2f2f2; /* Same background as header */
    color: #000; /* Ensure text color is black */
  }
  .pssuq-calculator .input-table td[contenteditable="true"] {
    background-color: #fff;
    cursor: text;
    color: #000; /* Ensure editable cell text is black */
  }
  .pssuq-calculator .results {
    background-color: #f7f7f7;
    padding: 10px; /* Reduced padding */
    border-radius: 5px;
    margin: 10px auto; /* Reduced margin */
    max-width: 600px;
  }
  .pssuq-calculator .results h3 {
    margin-top: 0;
    color: #000; /* Ensure results heading text is black */
  }
  .pssuq-calculator .results p {
    font-size: 18px; /* Increased font size */
    font-weight: bold; /* Made text bold */
    text-align: center; /* Centered text */
    margin: 5px 0;
    color: #000; /* Ensure results text is black */
  }
  .button-container {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
  }
  .pssuq-calculator button#calculate-button {
    padding: 15px 25px;
    background-color: #000; /* Black background */
    color: #fff; /* White text */
    border: none;
    font-size: 16px;
    cursor: pointer;
  }
  .pssuq-calculator button#calculate-button:hover {
    background-color: #333;
  }
  /* Responsive Design */
  @media (max-width: 600px) {
    .pssuq-calculator .input-table th, .pssuq-calculator .input-table td {
      font-size: 14px;
      padding: 6px;
      min-width: 60px;
    }
    .control-group input[type="text"] {
      width: 50px;
      padding: 5px;
      font-size: 14px;
    }
    .control-group button {
      font-size: 14px;
      padding: 8px 12px;
    }
    .pssuq-calculator button#calculate-button {
      font-size: 14px;
      padding: 12px 20px;
    }
    .pssuq-calculator .results {
      padding: 8px;
      max-width: 100%;
    }
    .pssuq-calculator .results p {
      font-size: 16px;
    }
    
    .pssuq-calculator .footer {
    border: 2px solid red; /* Temporary red border to see it */
    }    
    
    .pssuq-calculator .footer {
    background-color: #fff; /* White background */
    color: #000; /* Black text */
    text-align: center;
    padding: 15px; /* Space inside the footer */
    border-top: 1px solid #ccc; /* Light border line */
    margin-top: 20px; /* Space above the footer */
    height: auto; /* Ensure the footer adjusts to its content */
}
  }
</style>
<!-- End CSS Styling -->

<!-- Begin JavaScript -->
<script>
  // Variables for undo functionality
  let previousData = null;
  let isDataCleared = false;

  // Function to generate participant rows
  function generateParticipantRows(count) {
    const tableBody = document.getElementById('pssuq-table').getElementsByTagName('tbody')[0];
    for (let i = 1; i <= count; i++) {
      const newRow = document.createElement('tr');

      // Create Participant Number cell (non-editable)
      const participantCell = document.createElement('td');
      participantCell.textContent = tableBody.rows.length + 1;
      participantCell.style.color = '#000'; // Ensure text color is black
      newRow.appendChild(participantCell);

      // Create cells for Questions 1-16
      for (let j = 1; j <= 16; j++) {
        const cell = document.createElement('td');
        cell.contentEditable = 'true';
        cell.style.userSelect = 'text'; // Enable text selection
        cell.style.color = '#000'; // Ensure text color is black
        newRow.appendChild(cell);
      }

      tableBody.appendChild(newRow);
    }
  }

  // Generate initial 10 participant rows on page load
  generateParticipantRows(10);

  // Function to calculate averages for each sub-scale
  function calculateAverages() {
    const table = document.getElementById('pssuq-table');
    const rows = table.querySelectorAll('tbody tr');

    const sysuseQuestions = [1, 2, 3, 4, 5, 6];
    const infoqualQuestions = [7, 8, 9, 10, 11, 12];
    const interqualQuestions = [13, 14, 15, 16];

    let sysuseValues = [];
    let infoqualValues = [];
    let interqualValues = [];

    rows.forEach(row => {
      const cells = row.querySelectorAll('td');
      // Skip if row has no data
      if (cells.length < 17) return;

      // Collect responses for this participant
      for (let i = 1; i <= 16; i++) {
        const response = parseFloat(cells[i].textContent.trim());
        if (!isNaN(response)) {
          if (sysuseQuestions.includes(i)) {
            sysuseValues.push(response);
          } else if (infoqualQuestions.includes(i)) {
            infoqualValues.push(response);
          } else if (interqualQuestions.includes(i)) {
            interqualValues.push(response);
          }
        }
      }
    });

    // Calculate averages
    const sysuseAvg = sysuseValues.length > 0 ? (sysuseValues.reduce((a, b) => a + b, 0) / sysuseValues.length).toFixed(2) : null;
    const infoqualAvg = infoqualValues.length > 0 ? (infoqualValues.reduce((a, b) => a + b, 0) / infoqualValues.length).toFixed(2) : null;
    const interqualAvg = interqualValues.length > 0 ? (interqualValues.reduce((a, b) => a + b, 0) / interqualValues.length).toFixed(2) : null;

    // Update results display or show error if input is invalid
    document.getElementById('sysuse-result').textContent = sysuseAvg !== null ? sysuseAvg : 'Invalid input';
    document.getElementById('infoqual-result').textContent = infoqualAvg !== null ? infoqualAvg : 'Invalid input';
    document.getElementById('interqual-result').textContent = interqualAvg !== null ? interqualAvg : 'Invalid input';

    // Calculate overall average if all sub-scales have valid averages
    if (sysuseAvg !== null && infoqualAvg !== null && interqualAvg !== null) {
      const overallAvg = ((parseFloat(sysuseAvg) + parseFloat(infoqualAvg) + parseFloat(interqualAvg)) / 3).toFixed(2);
      document.getElementById('overall-result').textContent = overallAvg;
    } else {
      document.getElementById('overall-result').textContent = 'Invalid input in one or more sub-scales.';
    }
  }

  // Function to add participants based on user input
  function addParticipants() {
    const numberInput = document.getElementById('add-participants-number');
    const count = parseInt(numberInput.value);
    if (!isNaN(count) && count > 0) {
      generateParticipantRows(count);
    } else {
      alert('Please enter a valid number of participants to add.');
    }
  }

  // Function to remove participant rows
  function removeParticipants() {
    const startInput = document.getElementById('remove-start-number');
    const endInput = document.getElementById('remove-end-number');
    const startNum = parseInt(startInput.value);
    const endNum = parseInt(endInput.value);

    if (isNaN(startNum) || isNaN(endNum) || startNum < 1 || endNum < startNum) {
      alert('Please enter valid participant numbers to remove.');
      return;
    }

    const tableBody = document.getElementById('pssuq-table').getElementsByTagName('tbody')[0];
    const totalRows = tableBody.rows.length;

    // Adjust endNum if it exceeds the total number of participants
    const adjustedEndNum = Math.min(endNum, totalRows);

    for (let i = adjustedEndNum - 1; i >= startNum - 1; i--) {
      tableBody.deleteRow(i);
    }

    // Re-number the remaining participants
    const rows = tableBody.getElementsByTagName('tr');
    for (let i = 0; i < rows.length; i++) {
      rows[i].cells[0].textContent = i + 1;
    }
  }

  // Function to clear data with undo option
  function clearData() {
    const tableBody = document.getElementById('pssuq-table').getElementsByTagName('tbody')[0];
    previousData = tableBody.innerHTML; // Save current data
    isDataCleared = true;
    const cells = tableBody.querySelectorAll('td[contenteditable="true"]');
    cells.forEach(cell => {
      cell.textContent = '';
    });
    document.getElementById('undo-clear-button').disabled = false;
  }

  // Function to undo data clearing
  function undoClearData() {
    if (isDataCleared && previousData !== null) {
      const tableBody = document.getElementById('pssuq-table').getElementsByTagName('tbody')[0];
      tableBody.innerHTML = previousData;
      previousData = null;
      isDataCleared = false;
      document.getElementById('undo-clear-button').disabled = true;
    }
  }

  // Event listener for the Calculate button
  document.getElementById('calculate-button').addEventListener('click', calculateAverages);

  // Event listener for the Add Participants button
  document.getElementById('add-participants-button').addEventListener('click', addParticipants);

  // Event listener for the Remove Participants button
  document.getElementById('remove-participants-button').addEventListener('click', removeParticipants);

  // Event listeners for Clear Data and Undo buttons
  document.getElementById('clear-data-button').addEventListener('click', clearData);
  document.getElementById('undo-clear-button').addEventListener('click', undoClearData);

  // Function to handle paste event in the table
  function handleTablePaste(event) {
    event.preventDefault();

    const clipboardData = event.clipboardData || window.clipboardData;
    const pastedData = clipboardData.getData('Text');

    // Get the starting cell
    const startCell = event.target;
    const startRow = startCell.parentElement;
    const startRowIndex = startRow.rowIndex - 2; // Adjust for header rows
    const startCellIndex = startCell.cellIndex;

    // Split the pasted data into rows and cells
    const rowsData = pastedData.trim().split('\n');
    const table = document.getElementById('pssuq-table');
    const tbody = table.querySelector('tbody');

    // Ensure enough rows exist
    while (startRowIndex + rowsData.length > tbody.rows.length) {
      generateParticipantRows(1);
    }

    rowsData.forEach((rowData, rowOffset) => {
      const values = rowData.split(/\t/);
      const currentRow = tbody.rows[startRowIndex + rowOffset];

      // Ensure enough cells exist in the row
      for (let i = currentRow.cells.length; i < startCellIndex + values.length; i++) {
        const cell = document.createElement('td');
        cell.contentEditable = 'true';
        cell.style.userSelect = 'text';
        cell.style.color = '#000'; // Ensure text color is black
        currentRow.appendChild(cell);
      }

      values.forEach((value, cellOffset) => {
        const cell = currentRow.cells[startCellIndex + cellOffset];
        if (cell && cell !== currentRow.cells[0]) { // Skip participant number cell
          cell.textContent = value.trim();
        }
      });
    });
  }

  // Attach paste event listener to the table body
  const tableBody = document.getElementById('pssuq-table').getElementsByTagName('tbody')[0];
  tableBody.addEventListener('paste', handleTablePaste);

  // Input validation to prevent non-numeric input in add/remove participant fields
  function validateNumberInput(event) {
    const key = event.key;
    if (!/[0-9]/.test(key) && key !== 'Backspace' && key !== 'Delete' && key !== 'ArrowLeft' && key !== 'ArrowRight') {
      event.preventDefault();
    }
  }

  document.getElementById('add-participants-number').addEventListener('keypress', validateNumberInput);
  document.getElementById('remove-start-number').addEventListener('keypress', validateNumberInput);
  document.getElementById('remove-end-number').addEventListener('keypress', validateNumberInput);
</script>
<!-- End JavaScript -->
</div>
